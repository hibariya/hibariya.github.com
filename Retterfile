#!/usr/bin/env ruby
# coding: utf-8

url         'http://hibariya.github.com/'
title       'Joy Luck Crab'
description '歓喜 幸福 象さん'
author      'hibariya'

after :edit do
  preview if yes?("Preview now? [yes/no]")
end

after :rebind, :commit

after :commit do
  if yes?("Deploy now? [yes/no]")
    system "cd #{config.retter_home}"
    system 'git push origin master'
  end

  if yes?("Bookmark now? [yes/no]")
    STDOUT.sync = true

    print 'Username: '
    username = STDIN.gets.strip
    print 'Password: '

    system "stty -echo"
    password =  STDIN.gets.strip
    system "stty echo"

    a = Mechanize.new
    a.get('https://www.hatena.ne.jp/login')
    form = a.page.forms.first
    form.field_with(name: 'name').value username
    form.field_with(name: 'password').value password
    form.click_button

  end
end
